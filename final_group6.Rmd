---
title: "Effect of Treatments on Glottic Cancer"
author: "Xiang Zhu & Shutian Lin (Group 6)"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document:
   df_print: paged
   toc: true 
   toc_depth: 4
   code_download: true
   code_folding: show
   number_sections: false
   theme: simplex 
   highlight: tango 
   toc_float:
     collapsed: true
     smooth_scroll: true
---

```{r,echo=FALSE}
knitr::opts_chunk$set(echo=FALSE, cache=TRUE, error=FALSE, message=FALSE, warning=FALSE, tidy.opts=list(width.cutoff=60),tidy=TRUE)
```


```{r, results = FALSE}
library(tidyverse)
library(readxl)
library(table1)
library(magrittr)
library(dplyr)

glottic <- read_excel("Glottic_Cancer_Data_Set_011521.xlsx")

# Check for missing value for each column
apply(glottic, 2, function(x) {
    sum(is.na(x))
})
```

```{r}
glottic <- glottic %>%
  filter(Death_Status != 1) %>%
  filter(!is.na(Age_dx)) %>%
  filter(Rad_Tx_Status != "U") %>%
  mutate(Rad_Tx_Status = as.numeric(Rad_Tx_Status)) %>%
  mutate(Death_Status = ifelse(Death_Status == 0, 0, 1)) %>%
  mutate(Race = ifelse(Race == 'Black' | Race == 'White', Race, "Others")) %>%
  rename("Tumor_Type" = Derived_AJCC,
         "Age" = Age_dx) %>%
  select(-Survival_mos)
glottic %<>% mutate_each_(funs(factor(.)), c("Tumor_Type", "Sex", "Race", "Rad_Tx_Status", "Death_Status"))
```


```{r}
# Descriptive table of all variables stratified by death status
table1 <- table1(~ Tumor_Type + Sex + Age + Race + Rad_Tx_Status | Death_Status, data=glottic)
```


### Description of the problem and scientific question

As one of the most common head and neck malignancies, glottic cancer makes up about 1% of global cancer in 2018 and causes 1% of the cancer deaths worldwide. Treatments for this type of cancer mainly involve surgery, radiation, or a combination of both surgery and radiation. The scientific question for this study is that: how do different types of treatments affect the survival in 36 months of patients with glottic cancer.

### Description of the dataset

#### Data definitions
The dataset of glottic cancer is from SEER, and the original data contains 4422 observations and 7 variables. The filtered data contains 3949 observations and 6 variables. There is only one missing value in Age column, so we remove this observation. Also, there are some unknown value in Rad_Tx_Status column (A: Treatment), and we remove all observations with unknown treatment status.

- Tumor_Type: American Joint Committee on Cancer staging classification system
  - T1a and T1b: The tumor is only in the vocal cords with normal mobility. T1a refers to cancer involvement of only one cord. T1b refers to cancer involvement of both cords.
  - T2: The tumor is large enough that it goes to the supraglottis and/or subglottis, and/or there is decreased movement of the vocal cord.
  - T1NOS: T1 tumor not otherwise specified.
- Sex: Female/Male
- Age: in years
- Race: White/Black/Others
- Rad_Tx_Status: Radiation/Surgery treatment status
  - 0 = Surgery only
  - 1 = Radiation only
  - 2 = Both surgery and radiation
  - 3 = Neither surgery nor radiation
- Death_Status: status at endpoint
  - 0 = Alive
  - 1 = Dead Cancer


#### Description of variables

```{r}
table1
```

#### Correlation between variables

```{r}
ggplot(glottic, aes(Age)) +
  geom_histogram(bins = 30)
```

```{r}
library(ggpubr)
ggplot(glottic, aes(x = Death_Status, y = Age)) +
  geom_boxplot(add = "jitter") +
  stat_compare_means(method = "t.test")
```

```{r}
# Tumor_Type
chisq.test(glottic$Death_Status, glottic$Tumor_Type)
# Sex
chisq.test(glottic$Death_Status, glottic$Sex)
# Race
chisq.test(glottic$Death_Status, glottic$Race)
# Rad_Tx_Status
chisq.test(glottic$Death_Status, glottic$Rad_Tx_Status)
```